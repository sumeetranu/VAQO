
<div class="col-sm-6" style="padding-left:0px;"> 
    <strong><center>Relational Algebra</center></strong>
    <br>
    <div class = "toolbar">
        <button class="btn btn-compact">π</button>
        <button class="btn btn-compact">σ</button>
        <button class="btn btn-compact">ρ</button>
        <button class="btn btn-compact">←</button>
        <button class="btn btn-compact">τ</button>
        <button class="btn btn-compact">γ</button>
        <button class="btn btn-compact">∧</button>
        <button class="btn btn-compact">∨</button>
        <button class="btn btn-compact">¬</button>
        <button class="btn btn-compact">=</button>
        <button class="btn btn-compact">≠</button>
        <button class="btn btn-compact">≥</button>
        <button class="btn btn-compact">≤</button>
        <button class="btn btn-compact">∩</button>
        <button class="btn btn-compact">∪</button>
        <button class="btn btn-compact">÷</button>
        <button class="btn btn-compact">-</button>
        <button class="btn btn-compact">⨯</button>
        <!--<button class="btn btn-compact">⨝</button>
        <button class="btn btn-compact">⟕</button>
        <button class="btn btn-compact">⟖</button>
        <button class="btn btn-compact">⟗</button>
        <button class="btn btn-compact">⋉</button>
        <button class="btn btn-compact">⋊</button>
        <button class="btn btn-compact">▷</button>
        <button class="btn btn-compact">=</button>
        <button class="btn btn-compact">--</button>
        <button class="btn btn-compact">/*</button>
        <button class="btn btn-compact">{}</button>-->
    </div>
    

    <div class = "box">
        <!-- CodeMirror -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.22.0/codemirror.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.22.0/mode/xml/xml.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.22.0/codemirror.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.22.0/mode/javascript/javascript.min.js"></script>
        <textarea placeholder="[Enter relational algebra queryy]" class="codearea" id="convertRaCodearea" style="width:100%; height:100%; display:none"></textarea>
        
        <script>
	        //window.onload = function () {
                var myTextArea = document.getElementById("convertRaCodearea");
                
                // RA Mode from ReLax
                CodeMirror.defineMode('relationalAlgebra', function () {
                    var keywords = [
                        'pi', 'sigma', 'rho', 'tau', '<-', '->', 'intersect', 'union', 'except', '/', '-', '\\\\', 'x', 'cross join', 'join',
                        'inner join', 'natural join', 'left join', 'right join', 'left outer join', 'right outer join',
                        'left semi join', 'right semi join', 'anti join', 'anti semi join', 'and', 'or', 'xor'
                    ];
                    var keywordsMath = ['π', 'σ', 'ρ', 'τ', '←', '→', '∩', '∪', '÷', '-', '⨯', '⨝', '⟕', '⟖', '⟗', '⋉', '⋊', '▷'];
                    var operators = ['<-', '->', '>=', '<=', '=', '∧', '∨', '⊻', '⊕', '≠', '=', '¬', '>', '<', '≥', '≤'];
                    var matchAny = function (stream, array, consume, successorPattern) {
                        for (var i = 0; i < array.length; i++) {
                            var needle;
                            if (!successorPattern)
                                needle = array[i];
                            else
                                needle = new RegExp('^' + array[i] + successorPattern);

                            if (stream.match(needle, consume))
                                return true;
                        }
                        return false;
                    };
                    var seperators = '([\\(\\)\[\\]\{\\}, \\.\\t]|$)';

                    return {
                        startState: function () {
                            return {
                                inBlockComment: false
                            };
                        },
                        token: function (stream, state) {
                            if (state.inBlockComment) {
                                if (stream.match(/.*?\*\//, true))
                                    state.inBlockComment = false;
                                else
                                    stream.match(/.*/, true);
                                return 'comment';
                            }
                            else if (!state.inBlockComment && stream.match(/^\/\*.*/, true)) {
                                state.inBlockComment = true;
                                return 'comment';
                            }

                            else if (state.inInlineRelation) {
                                if (stream.match(/.*?}/, true))
                                    state.inInlineRelation = false;
                                else
                                    stream.match(/.*/, true);
                                return 'inlineRelation';
                            }
                            else if (stream.match(/^{/, true)) {
                                state.inInlineRelation = true;
                                return 'inlineRelation';
                            }

                            else if (stream.match(/^--[\t ]/, true)) {
                                stream.skipToEnd();
                                return 'comment';
                            }
                            else if (stream.match(/^\/\*.*?$/, true)) {
                                return 'comment';
                            }
                            else if (matchAny(stream, keywordsMath, true)) {
                                return 'keyword math'; // needed for the correct font
                            }
                            else if (matchAny(stream, keywords, true, seperators)) {
                                return 'keyword';
                            }
                            else if (matchAny(stream, operators, true)) {
                                return 'operator math';
                            }
                            else if (stream.match(/^\[[0-9]+]/, true)) {
                                return 'attribute';
                            }
                            else if (stream.match(/^[0-9]+(\.[0-9]+)?/, true)) {
                                return 'number';
                            }
                            else if (stream.match(/\^'[^']*'/i, true)) {
                                return 'string';
                            }
                            else if (stream.match(/\^[a-z]+\.[a-z]*/i, true)) {
                                return 'qualified-column';
                            }
                            else if (stream.match(/^[\(\)\[]\{},]/i, true)) {
                                return 'bracket';
                            }
                            else if (stream.match(/^[a-z][a-z0-9\.]*/i, true)) {
                                return 'word';
                            }
                            else {
                                stream.next();
                                return 'else';
                            }

                        }
                    };
                });

                var minLines = 10;
                var startingValue = '';
                for (var i = 0; i < minLines; i++) {
                    startingValue += '\n';
                }

                var editor = CodeMirror.fromTextArea(document.getElementById('convertRaCodearea'), 
                    {
                        mode:  "relationalAlgebra", 
                        lineNumbers: true,
                        gutters: ["CodeMirror-linenumbers"]
                    } 
                );
                editor.setValue(startingValue);
            //};  
        </script>
    </div>



    <br>
    <div style="text-align:right"><button class="btn btn-red" ng-click="convert.convertToSql()">Convert to SQL</button></div>
    <br>
</div>

<div class="col-sm-6" style="padding-left:0px;"> 
    <strong><center>SQL</center></strong>
    <br>
    <div class = "toolbar">
        <button class="btn btn-compact">π</button>
        <button class="btn btn-compact">σ</button>
        <button class="btn btn-compact">ρ</button>
        <button class="btn btn-compact">←</button>
        <button class="btn btn-compact">τ</button>
        <button class="btn btn-compact">γ</button>
        <button class="btn btn-compact">∧</button>
        <button class="btn btn-compact">∨</button>
        <button class="btn btn-compact">¬</button>
        <button class="btn btn-compact">=</button>
        <button class="btn btn-compact">≠</button>
        <button class="btn btn-compact">≥</button>
        <button class="btn btn-compact">≤</button>
        <button class="btn btn-compact">∩</button>
        <button class="btn btn-compact">∪</button>
        <button class="btn btn-compact">÷</button>
        <button class="btn btn-compact">-</button>
        <button class="btn btn-compact">⨯</button>
        <!--<button class="btn btn-compact">⨝</button>
        <button class="btn btn-compact">⟕</button>
        <button class="btn btn-compact">⟖</button>
        <button class="btn btn-compact">⟗</button>
        <button class="btn btn-compact">⋉</button>
        <button class="btn btn-compact">⋊</button>
        <button class="btn btn-compact">▷</button>
        <button class="btn btn-compact">=</button>
        <button class="btn btn-compact">--</button>
        <button class="btn btn-compact">/*</button>
        <button class="btn btn-compact">{}</button>-->
    </div>
    
    <div class = "box">
        <!-- CodeMirror -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.22.0/codemirror.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.22.0/mode/xml/xml.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.22.0/codemirror.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.22.0/mode/javascript/javascript.min.js"></script>
        <textarea placeholder="[Enter relational algebra queryy]" class="codearea" id="convertSqlCodearea" style="width:100%; height:100%; display:none"></textarea>
        
        <script>
	        //window.onload = function () {
                var myTextArea = document.getElementById("convertSqlCodearea");
                
                // RA Mode from ReLax
                CodeMirror.defineMode('relationalAlgebra', function () {
                    var keywords = [
                        'pi', 'sigma', 'rho', 'tau', '<-', '->', 'intersect', 'union', 'except', '/', '-', '\\\\', 'x', 'cross join', 'join',
                        'inner join', 'natural join', 'left join', 'right join', 'left outer join', 'right outer join',
                        'left semi join', 'right semi join', 'anti join', 'anti semi join', 'and', 'or', 'xor'
                    ];
                    var keywordsMath = ['π', 'σ', 'ρ', 'τ', '←', '→', '∩', '∪', '÷', '-', '⨯', '⨝', '⟕', '⟖', '⟗', '⋉', '⋊', '▷'];
                    var operators = ['<-', '->', '>=', '<=', '=', '∧', '∨', '⊻', '⊕', '≠', '=', '¬', '>', '<', '≥', '≤'];
                    var matchAny = function (stream, array, consume, successorPattern) {
                        for (var i = 0; i < array.length; i++) {
                            var needle;
                            if (!successorPattern)
                                needle = array[i];
                            else
                                needle = new RegExp('^' + array[i] + successorPattern);

                            if (stream.match(needle, consume))
                                return true;
                        }
                        return false;
                    };
                    var seperators = '([\\(\\)\[\\]\{\\}, \\.\\t]|$)';

                    return {
                        startState: function () {
                            return {
                                inBlockComment: false
                            };
                        },
                        token: function (stream, state) {
                            if (state.inBlockComment) {
                                if (stream.match(/.*?\*\//, true))
                                    state.inBlockComment = false;
                                else
                                    stream.match(/.*/, true);
                                return 'comment';
                            }
                            else if (!state.inBlockComment && stream.match(/^\/\*.*/, true)) {
                                state.inBlockComment = true;
                                return 'comment';
                            }

                            else if (state.inInlineRelation) {
                                if (stream.match(/.*?}/, true))
                                    state.inInlineRelation = false;
                                else
                                    stream.match(/.*/, true);
                                return 'inlineRelation';
                            }
                            else if (stream.match(/^{/, true)) {
                                state.inInlineRelation = true;
                                return 'inlineRelation';
                            }

                            else if (stream.match(/^--[\t ]/, true)) {
                                stream.skipToEnd();
                                return 'comment';
                            }
                            else if (stream.match(/^\/\*.*?$/, true)) {
                                return 'comment';
                            }
                            else if (matchAny(stream, keywordsMath, true)) {
                                return 'keyword math'; // needed for the correct font
                            }
                            else if (matchAny(stream, keywords, true, seperators)) {
                                return 'keyword';
                            }
                            else if (matchAny(stream, operators, true)) {
                                return 'operator math';
                            }
                            else if (stream.match(/^\[[0-9]+]/, true)) {
                                return 'attribute';
                            }
                            else if (stream.match(/^[0-9]+(\.[0-9]+)?/, true)) {
                                return 'number';
                            }
                            else if (stream.match(/\^'[^']*'/i, true)) {
                                return 'string';
                            }
                            else if (stream.match(/\^[a-z]+\.[a-z]*/i, true)) {
                                return 'qualified-column';
                            }
                            else if (stream.match(/^[\(\)\[]\{},]/i, true)) {
                                return 'bracket';
                            }
                            else if (stream.match(/^[a-z][a-z0-9\.]*/i, true)) {
                                return 'word';
                            }
                            else {
                                stream.next();
                                return 'else';
                            }

                        }
                    };
                });

                var minLines = 10;
                var startingValue = '';
                for (var i = 0; i < minLines; i++) {
                    startingValue += '\n';
                }

                var editor = CodeMirror.fromTextArea(document.getElementById('convertSqlCodearea'), 
                    {
                        mode:  "text/x-mysql", 
                        lineNumbers: true,
                        gutters: ["CodeMirror-linenumbers"]
                    } 
                );
                editor.setValue(startingValue);
            //};  
        </script>
    </div>



    <br>
    <div style="text-align:right"><button class="btn btn-red" ng-click="convert.convertToRelAlg()">Convert to Relational Algebra</button></div>
    <br>
</div>